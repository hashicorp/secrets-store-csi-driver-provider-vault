# Values file for vaul-helm chart.
global:
  tlsDisable: false

injector:
  enabled: false

server:
  image:
    repository: docker.mirror.hashicorp.services/vault
  volumes:
  - name: vault-server-tls
    secret:
      secretName: vault-server-tls
  - name: vault-bootstrap
    configMap:
      name: vault-bootstrap
  volumeMounts:
  - name: vault-server-tls
    mountPath: /mnt/tls
    readOnly: true
  - name: vault-bootstrap
    mountPath: /mnt/bootstrap
    readOnly: true

  extraEnvironmentVars:
    # Ensure that running vault commands in the pod uses the correct CA.
    VAULT_CACERT: /mnt/tls/ca.crt

  standalone:
    enabled: true
    config: |
      listener "tcp" {
        address = "[::]:8200"
        cluster_address = "[::]:8201"
        tls_cert_file = "/mnt/tls/server.crt"
        tls_key_file = "/mnt/tls/server.key"
        tls_client_ca_file = "/mnt/tls/ca.crt"
      }
      storage "inmem" {
      }

  readinessProbe:
    path: "/v1/sys/health?standbyok=true&sealedcode=204&uninitcode=204"

csi:
  enabled: true

  volumes:
  - name: vault-client-tls
    secret:
      secretName: vault-client-tls
  volumeMounts:
  - name: vault-client-tls
    mountPath: /mnt/tls
    readOnly: true
